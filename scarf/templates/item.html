{% extends "layout.html" %}

{% block body %}

{% include "login.html" %}

<div id="content">

<div id="itemname">
<h1>{{ pd.item.name }}</h1>
<a href="/item/{{ pd.item.name }}/edit">Edit</a><br />
<a href="/item/{{ pd.item.name }}/history">History</a><br />
</div>

{% if pd.item.old %}
<a href="/item/{{ pd.item.name }}/revert/{{ pd.item.editid }}">Revert to this version</a>
<div id="warning">
You are viewing a historical version of this item's description, click <a href="/item/{{ pd.item.name }}">here</a> for the latest version. 
</div>
{% endif %}


<div id="description">
{{ pd.item.description_html|safe }}
</div>

<div id="itemactions">

{% if pd.authuser is defined and pd.authuser.accesslevel == 255 %}
<a href="/item/{{ pd.item.name }}/delete">Delete item</a><br />
{% endif %}


{% if pd.authuser is defined %}
    {% if pd.iteminfo is defined and pd.iteminfo.have == 0 %}
        <a href="/item/{{ pd.item.name }}/have">I own this</a></br>

    {% else %}
        This is in your collection. <a href="/item/{{ pd.item.name }}/donthave">Remove it</a>.<br />

        {% if pd.iteminfo is defined and pd.iteminfo.willtrade == 0 %}
        <a href="/item/{{ pd.item.name }}/willtrade">I'll trade this</a><br />
        {% else %}
        This is up for trade. <a href="/item/{{ pd.item.name }}/wonttrade">Nevermind</a>.<br />
        {% endif %}

    {% endif %}

    {% if pd.iteminfo is defined and pd.iteminfo.want == 0 %}
    <a href="/item/{{ pd.item.name }}/want">I want this</a></br>
    {% else %}
    You want this. <a href="/item/{{ pd.item.name }}/dontwant">Nevermind.</a><br />
    {% endif %}

{% else %}

<a href="/item/{{ pd.item.name }}/have">I own this</a><br />
<a href="/item/{{ pd.item.name }}/willtrade">I'll trade this</a><br />
<a href="/item/{{ pd.item.name }}/want">I want this</a><br />

{% endif %}
</div>
<div class="havecount">
{% if pd.item.haveusers()[0] == 1 %}
1 person has this<br />
{% else %}
{{ pd.item.haveusers()[0] }} people have this<br />
{% endif %}

{% for user in pd.item.haveusers()[1] %}
<a href="/user/{{ user.username }}">{{ user.username }}</a><br />
{% endfor %}
</div>

<div class="willtradecount">
{% if pd.item.willtradeusers()[0] == 1 %}
1 person is willing to trade this <br />
{% else %}
{{ pd.item.willtradeusers()[0] }} people are willing to trade this <br />
{% endif %}

{% for user in pd.item.willtradeusers()[1] %}
<a href="/user/{{ user.username }}/trade/{{pd.item.name}}">{{ user.username }}</a><br />
{% endfor %}

</div>

<div class="wantscount">
{% if pd.item.wantusers()[0] == 1 %}
1 person wants to trade for this <br />
{% else %}
{{ pd.item.wantusers()[0] }} people want to trade for this <br />
{% endif %}

{% for user in pd.item.wantusers()[1] %}
<a href="/user/{{ user.username }}/trade/{{pd.item.name}}">{{ user.username }}</a><br />
{% endfor %}
</div>

</div>

{% endblock %}
